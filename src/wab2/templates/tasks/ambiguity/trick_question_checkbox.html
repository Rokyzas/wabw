        <div class="app-content-area">
            <div class="preferences-container">
                <div class="preferences-header">
                    <h3>Email Preferences</h3>
                    <p class="subtitle">Manage how we communicate with you</p>
                </div>
                
                <div class="preferences-content">
                    <div class="preference-group">
                        <h4>Account Setup</h4>
                        <p class="preference-description">Enter your email address to manage your preferences.</p>
                        
                        <div class="form-group">
                            <input type="email" id="email-input" class="form-control" placeholder="Enter your email address" required>
                        </div>
                    </div>

                    <div class="preference-group">
                        <h4>Email Preferences</h4>
                        <p class="preference-description">Manage your email communication preferences.</p>
                        
                        <div class="checkbox-group">
                            <div class="toggle-group">
                                <span class="toggle-label">Would you like to receive special offers?</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="special-offers-toggle" class="toggle-input" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="frequency-group">
                                <p class="frequency-question">How often would you like to receive emails?</p>
                                <div class="radio-group">
                                    <label class="radio-item">
                                        <input type="radio" name="frequency" value="daily" class="frequency-radio" checked>
                                        <span>Daily</span>
                                    </label>
                                    <label class="radio-item">
                                        <input type="radio" name="frequency" value="weekly" class="frequency-radio">
                                        <span>Weekly</span>
                                    </label>
                                    <label class="radio-item">
                                        <input type="radio" name="frequency" value="monthly" class="frequency-radio">
                                        <span>Monthly</span>
                                    </label>
                                    <label class="radio-item">
                                        <input type="radio" name="frequency" value="never" class="frequency-radio">
                                        <span>Never</span>
                                    </label>
                                </div>
                            </div>

                            <label class="checkbox-item">
                                <input type="checkbox" id="newsletter-checkbox" class="preference-checkbox" checked>
                                <span class="checkbox-label">
                                    Uncheck this box if you don't want to receive our newsletter
                                </span>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="promotions-checkbox" class="preference-checkbox" checked>
                                <span class="checkbox-label">
                                    Check this box to not receive promotional offers
                                </span>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="marketing-checkbox" class="preference-checkbox" checked>
                                <span class="checkbox-label">
                                    I do not wish to not receive marketing emails
                                </span>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="updates-checkbox" class="preference-checkbox">
                                <span class="checkbox-label">
                                    Do not send me product updates
                                </span>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="events-checkbox" class="preference-checkbox">
                                <span class="checkbox-label">
                                    Uncheck this box if you want to receive event invitations
                                </span>
                            </label>
                        </div>
                    </div>

                    <div class="preference-group">
                        <h4>Data Sharing</h4>
                        <p class="preference-description">Control how your data is shared with third parties.</p>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="partners-checkbox" class="preference-checkbox">
                                <span class="checkbox-label">
                                    Share my information with partners
                                </span>
                            </label>

                            <label class="checkbox-item">
                                <input type="checkbox" id="analytics-checkbox" class="preference-checkbox">
                                <span class="checkbox-label">
                                    Allow anonymous usage data collection
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button id="save-preferences" class="action-button" disabled>
                            Save Preferences
                        </button>
                    </div>
                </div>
            </div>
        </div>

<style>
    .simulated-app-card {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-radius: 10px;
        overflow: hidden;
        background: white;
        margin-bottom: 30px;
    }
    
    .preferences-container {
        background-color: #fff;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 1.5rem;
        width: 100%;
    }
    
    .preferences-header {
        padding: 2rem 1.5rem;
        text-align: center;
        background-color: #f8f9fa;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .preferences-header h3 {
        margin: 0 0 0.5rem 0;
        color: #333;
        font-size: 1.5rem;
    }
    
    .subtitle {
        margin: 0;
        color: #6c757d;
        font-size: 1.1rem;
    }
    
    .preferences-content {
        padding: 2rem 2.5rem;
    }
    
    .preference-group {
        margin-bottom: 2rem;
    }
    
    .preference-group h4 {
        margin: 0 0 0.5rem 0;
        color: #333;
        font-size: 1.2rem;
    }
    
    .preference-description {
        margin: 0 0 1.5rem 0;
        color: #6c757d;
        font-size: 0.95rem;
    }
    
    .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
        width: 100%;
    }
    
    .checkbox-item {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 4px;
        transition: background-color 0.2s ease;
    }
    
    .checkbox-item:hover {
        background-color: #f8f9fa;
    }
    
    .preference-checkbox {
        margin-top: 0.25rem;
        width: 20px;
        height: 20px;
        cursor: pointer;
        appearance: none !important;
        -webkit-appearance: none !important;
        -moz-appearance: none !important;
        border: 2px solid #6c757d !important;
        border-radius: 4px;
        background-color: white !important;
        position: relative;
        transition: all 0.2s ease;
        flex-shrink: 0;
        box-sizing: border-box;
        color: initial !important;
        display: inline-block !important;
    }
    
    .preference-checkbox:checked {
        background-color: #007bff !important;
        border-color: #007bff !important;
    }
    
    .preference-checkbox:checked::before {
        content: '' !important;
        position: absolute;
        left: 6px;
        top: 2px;
        width: 5px;
        height: 10px;
        border: solid white !important;
        border-width: 0 2px 2px 0 !important;
        transform: rotate(45deg) !important;
        pointer-events: none !important;
    }
    
    .preference-checkbox:checked::after {
        display: none !important;
    }
    
    .preference-checkbox:hover {
        border-color: #007bff;
    }
    
    .preference-checkbox:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }
    
    .checkbox-label {
        font-size: 1rem;
        color: #333;
        line-height: 1.4;
        cursor: pointer;
        user-select: none;
    }
    
    .action-button {
        display: block;
        width: 100%;
        padding: 1rem;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 6px;
        font-size: 1.1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.2s ease;
    }
    
    .action-button:hover {
        background-color: #0069d9;
    }
    
    .feedback-message {
        font-size: 16px;
        text-align: center;
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        display: none;
    }
    
    .feedback-message.success {
        background-color: #d4edda;
        color: #155724;
        display: block;
    }
    
    .feedback-message.error {
        background-color: #f8d7da;
        color: #721c24;
        display: block;
    }
    
    @media (max-width: 768px) {
        .simulated-app-card {
            width: 95%;
            margin: 0 auto 30px auto;
        }
        
        .preferences-header {
            padding: 1.5rem 1rem;
        }
        
        .preferences-content {
            padding: 1.5rem 1rem;
        }
    }
    
    .radio-group {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .radio-item {
        padding: 0.75rem;
    }
    
    .frequency-radio {
        width: 18px;
        height: 18px;
        cursor: pointer;
        appearance: none !important;
        -webkit-appearance: none !important;
        -moz-appearance: none !important;
        border: 2px solid #6c757d !important;
        border-radius: 50%;
        background-color: white !important;
        position: relative;
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box;
    }
    
    .frequency-radio:checked {
        background-color: white !important;
        border-color: #007bff !important;
    }
    
    .frequency-radio:checked::after {
        content: '' !important;
        position: absolute;
        width: 10px;
        height: 10px;
        background-color: #007bff !important;
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    
    .frequency-radio:hover {
        border-color: #007bff;
    }
    
    .frequency-radio:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }
    
    .action-button:disabled {
        background-color: #6c757d;
        cursor: not-allowed;
        opacity: 0.65;
    }
    
    .form-group {
        margin-bottom: 1.5rem;
    }
    
    .form-control {
        width: 100%;
        padding: 0.75rem;
        font-size: 1rem;
        border: 2px solid #e0e0e0;
        border-radius: 4px;
        transition: border-color 0.2s ease;
    }
    
    .form-control:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }

    .frequency-group {
        margin: 1.25rem 0;
        padding: 1.25rem;
        background-color: #f8f9fa;
        border-radius: 4px;
        border: 1px solid #e0e0e0;
        width: 100%;
        box-sizing: border-box;
    }

    .frequency-question {
        margin: 0 0 1rem 0;
        color: #333;
        font-size: 1rem;
        font-weight: 500;
    }

    .toggle-group {
        display: flex;
        align-items: center;
        padding: 1.25rem;
        margin: 0.5rem 0;
        background-color: #f8f9fa;
        border-radius: 4px;
        border: 1px solid #e0e0e0;
        width: 100%;
        box-sizing: border-box;
    }

    .toggle-label {
        font-size: 1rem;
        color: #333;
        font-weight: 500;
        margin-right: auto;
    }

    .toggle-switch {
        position: relative !important;
        display: inline-block !important;
        width: 50px !important;
        height: 24px !important;
        margin-left: 1.5rem !important;
        flex-shrink: 0 !important;
    }

    .toggle-input {
        opacity: 0 !important;
        width: 0 !important;
        height: 0 !important;
        position: absolute !important;
    }

    .toggle-slider {
        position: absolute !important;
        cursor: pointer !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        background-color: #e4e4e4 !important;
        transition: .4s !important;
        border-radius: 24px !important;
        border: 1px solid #ccc !important;
    }

    .toggle-slider:before {
        position: absolute !important;
        content: "" !important;
        height: 18px !important;
        width: 18px !important;
        left: 2px !important;
        bottom: 2px !important;
        background-color: white !important;
        transition: .4s !important;
        border-radius: 50% !important;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2) !important;
    }

    .toggle-input:checked + .toggle-slider {
        background-color: #007bff !important;
        border-color: #007bff !important;
    }

    .toggle-input:checked + .toggle-slider:before {
        transform: translateX(26px) !important;
    }

    .toggle-input:focus + .toggle-slider {
        box-shadow: 0 0 1px #007bff !important;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Define fallback functions if they don't exist in the global scope
    if (typeof window.completeTask !== 'function') {
        console.warn('window.completeTask was not found, using fallback implementation');
        window.completeTask = function(success) {
            console.log('Task completed:', success);
            alert('Task completed! (fallback implementation)');
        };
    }
    
    if (typeof window.recordMistake !== 'function') {
        console.warn('window.recordMistake was not found, using fallback implementation');
        window.recordMistake = function(code, details, message) {
            console.log('Mistake recorded:', code, details, message);
            alert('Mistake: ' + message);
        };
    }

    const emailInput = document.getElementById('email-input');
    const newsletterCheckbox = document.getElementById('newsletter-checkbox');
    const frequencyRadios = document.querySelectorAll('input[name="frequency"]');
    const marketingCheckbox = document.getElementById('marketing-checkbox');
    const promotionsCheckbox = document.getElementById('promotions-checkbox');
    const updatesCheckbox = document.getElementById('updates-checkbox');
    const specialOffersToggle = document.getElementById('special-offers-toggle');
    const eventsCheckbox = document.getElementById('events-checkbox');
    const partnersCheckbox = document.getElementById('partners-checkbox');
    const analyticsCheckbox = document.getElementById('analytics-checkbox');
    const saveButton = document.getElementById('save-preferences');
    
    let isTaskComplete = false;
    const validEmails = ['user@gmail.com']; // Valid email addresses
    
    // Enable save button only when email is entered and frequency is selected
    function updateSaveButton() {
        const hasEmail = emailInput.value.includes('@');
        const hasFrequency = Array.from(frequencyRadios).some(radio => radio.checked);
        saveButton.disabled = !hasEmail || !hasFrequency;
    }
    
    emailInput.addEventListener('input', updateSaveButton);
    frequencyRadios.forEach(radio => {
        radio.addEventListener('change', updateSaveButton);
    });
    
    // Handle save button click
    saveButton.addEventListener('click', function() {
        if (isTaskComplete) return;
        
        // Check if email is valid - only accept the specific email address
        const enteredEmail = emailInput.value.trim().toLowerCase();
        const isEmailValid = validEmails.includes(enteredEmail);
        
        if (!isEmailValid) {
            window.recordMistake(
                'invalid_email',
                `Email '${enteredEmail}' is not allowed`,
                `Please use '${validEmails[0]}' as your email address.`
            );
            return; // Stop execution if email is invalid
        }
        
        // Check if choices are correct
        const isCorrect = !newsletterCheckbox.checked && // Uncheck if you don't want to receive = don't receive
            !marketingCheckbox.checked && // Double negative (don't not send = send)
            promotionsCheckbox.checked && // Check to not receive = don't receive
            updatesCheckbox.checked && // Single negative (do not send = don't send)
            !specialOffersToggle.checked && // Toggle off = don't receive
            !eventsCheckbox.checked; // Uncheck if you want to receive = don't receive

        if (isCorrect) {
            // Success - correct choices and valid email
            window.completeTask(true);
            isTaskComplete = true;
        } else {
            // Record specific mistakes
            if (newsletterCheckbox.checked) {
                window.recordMistake(
                    'newsletter_misunderstood',
                    'User didn\'t uncheck the newsletter box',
                    'To avoid receiving the newsletter, you should uncheck the box that says "Uncheck this box if you don\'t want to receive our newsletter"'
                );
            }
            
            if (marketingCheckbox.checked) {
                window.recordMistake(
                    'marketing_double_negative',
                    'User didn\'t understand the double negative in marketing emails',
                    'The statement "I do not wish to not receive marketing emails" contains a double negative. It means you DO want to receive marketing emails, so you should uncheck it.'
                );
        }
        
            if (!promotionsCheckbox.checked) {
                window.recordMistake(
                    'promotions_misunderstood',
                    'User didn\'t check the promotions box',
                    'To avoid receiving promotional offers, you should check the box that says "Check this box to not receive promotional offers"'
                );
            }
            
            if (!updatesCheckbox.checked) {
                window.recordMistake(
                    'updates_misunderstood',
                    'User didn\'t check the updates box',
                    'To avoid receiving product updates, you should check the box that says "Do not send me product updates"'
                );
            }
            
            if (specialOffersToggle.checked) {
                window.recordMistake(
                    'special_offers_toggle',
                    'User left the special offers toggle on',
                    'To avoid receiving special offers, you should turn off the toggle'
                );
            }
            
            if (eventsCheckbox.checked) {
                window.recordMistake(
                    'events_misunderstood',
                    'User left the events box checked',
                    'The statement says "Uncheck this box if you want to receive event invitations". Since you want to avoid promotional emails, you should leave it unchecked.'
                );
            }
            }
        });
});
</script> 